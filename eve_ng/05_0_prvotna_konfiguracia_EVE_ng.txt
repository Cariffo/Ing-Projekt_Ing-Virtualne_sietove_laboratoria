**************   !!!!!!!!!!!!!!!!!!!!!!! **************
Kroky, ktore sme už vykonali v predchádzajúcich častiach,
môžeme vynechať
**************   !!!!!!!!!!!!!!!!!!!!!!! **************

Follow the Ubuntu server installation. During install please choose only OpenSSH server as a feature to be installed !!!!

After the installation of Ubuntu server is done, follow the steps below in order to install the EVE. For futher convenient choose hostname as eve-ng.

1. Login with your user as root (via SSH or console). If we installed EVE-ng with the tutorial "4_instalacia_eve_ng_pre_vmware_player", then the default credentials are already set (root/eve) and jump to step 4.

sudo su

2. Change root password:

This password change option is only for how to purposes, of course you can choose your own root password, but don't forget that it will be used in the Wireshark wrapper file!

sudo passwd root
root@eve-ng:~# sudo passwd root
Enter new UNIX password: eve
Retype new UNIX password: eve
passwd: password updated successfully

3. Change hostname if you like, for save settings do (:wq):

vim.tiny /etc/hostname 

eve-ng



vim.tiny /etc/hosts                                               

 GNU vim.tiny 2.5.3                       File: /etc/hosts                                                      
127.0.0.1       localhost
127.0.1.1       eve-ng.example.com      eve-ng

4. Allow access to use root user ssh, edit line below:

vim.tiny /etc/ssh/sshd_config

PermitRootLogin prohibit-password
to
PermitRootLogin yes


5. Save settings (:wq) and do restart ssh server:

sudo service ssh restart
alebo
sudo systemctl restart ssh


6. Restart your server:

reboot


7. TENTO KROK NIE JE POTREBNY. After first boot, ssh IP to your server and modify:

sed -i -e 's/GRUB_CMDLINE_LINUX=""/GRUB_CMDLINE_LINUX="net.ifnames=0"/'  /etc/default/grub
update-grub


8. IMPORTANT!!! Do adding’s and necessary changes for this file below. It can also to be a static IP as well, follow Linux Ubuntu how to set stat IP for the interface. example below showing DHCP IP settings.

!!! Warning !!! after GRUB update changed interface names to ethX, original name after first boot will not work !!!!! Do edit the following below and reboot!!!

vim.tiny /etc/network/interfaces

# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
# This is an autoconfigured IPv6 interface
auto eth0
iface eth0 inet static
	address <verejna_ip_servera>
	netmask <maska>
	gateway <predvolena_brana>
	dns-nameservers <ip_dns_servera>
iface eth0 inet6 manual




   8.1. Option for Broadcom interfaces NetXtreme II 10Gb, not necessary for regular servers:

     apt-get install firmware-bnx2x

9. Save :wq settings and reboot:

reboot

10. Get the eve key from repositary:

  wget -O - http://www.eve-ng.net/repo/eczema@ecze.com.gpg.key | sudo apt-key add -

11. Update server:

  sudo apt-get install aptitude
  sudo aptitude update
  sudo aptitude install software-properties-common python3-software-properties python-software-properties
  sudo add-apt-repository "deb [arch=amd64]  http://www.eve-ng.net/repo xenial main"
  sudo apt-get update

("add-apt-repository" command not found => https://askubuntu.com/questions/493460/how-to-install-add-apt-repository-using-the-terminal)

12. Install the EVE:
  (as root)
  DEBIAN_FRONTEND=noninteractive apt-get -y install eve-ng

  (as sudo)
  DEBIAN_FRONTEND=noninteractive sudo apt-get -y install eve-ng

13. Restartujeme server

  reboot

14. Continue with post installation

=========================

In this guide we'll go over steps to configure proxy, DNS, IP and other settings on EVE:

 

The first boot requires additional configuration. Start the EVE VM/BareMetal Server:

After a while the console login prompt will be available. If not, log in as root and run:

  sudo /opt/ovf/ovfconfig.sh

By default the EVE will look for an IP address using DHCP protocol. Login as root with default password eve and start the configuration. Insert the root password twice:

Type the hostname (default is eve-ng):

Type the domain name (default is example.com):

Mind that hostname and domain name are critical for IOU/IOL license.

Select if management IP address should be static or configured by DHCP (default is dhcp, use arrow keys and space to select, then enter to confirm):
(ZVOLIME STATICKU IP)
Static IP address will ask for IP address, netmask, default gateway, primary and secondary DNS servers.

Type the NTP server or leave blank if not used (default is blank):

Configure how the EVE VM/BareMetal Server can access Internet (default is direct connection, use arrow keys and space to select, then enter to confirm):

None default options will require proxy hostname and port (default is proxy.example.com:8080) and username/password with authenticated proxy.

After the last confirm EVE will reboot. When the VM/BareMetal Server is up and running, SSH can be used to manage it, not before.

Finally you should upgrade system and EVE to latest version:

  apt-get update
  apt-get upgrade




-nainstalujeme doplnanie prikazov pre bash a dalsie nastroje

  sudo apt-get install bash-completion man-db tmux python-pip datamash

-pridame sa do skupiny "kvm" (kvoli guestfish utilitke)
 
  sudo usermod -aG kvm $USER




EVE-ng server je teraz nainstalovany. Na to, aby bol pripravený na použtie z webového rozhrania, musime pridat vynimky do firewallu pre porty:
  80/443 - HTTP/HTTPS
  22 - SSH
  32768-64536 - TCP aj UDP - zariadenia (telnet/vnc/rdp)


Po uprave pravidiel vo firewalle otvoríme internetový prehľadávač a zadáme doň adresu EVE-ng serveru (napr. 192.168.1.137 - IPčku zistíme príkazom “ip a” na interface-i “pnet0”)

Prihlásime sa ako
	admin
s heslom
	eve

Po prihlásení sa do webového rozhrania môžeme spravovať topológie a zariadenia.
Poznámka: Jeden používateľ môže byť súčasne prihlásený len z jedného počítača. Akonáhle sa prihlási z iného počítača, z predošlého ho server odhlási.

Vypneme UKMS (Universal Kernel Samepage Merging) v EVE-ng
  Úlohou UKMS je šetrenie operačnej pamäte pri spúšťaní viacerých QEMU zariadení rovnakého typu. To ale zvyšuje záťaž na procesor. Podľa EVE-ng dokumentácie treba UKMS vypnúť, keď chceme spúšťať na serveri viac ako 10 QEMU zariadení. Zrejme to zaťažuje procesor natoľko, že to ovplyvňuje výkon bežiacich QEMU zariadení.

Z bezpečnostných dôvodov odporucam okamžite zmenit heslo administrátorského účtu do web rozhrania. Heslá sú na EVE-ng serveri uložené v MySQL databázi (narozdiel od UNetLab-u, kde boli ulozene v SQLite databazi). (vid "http://www.eve-ng.net/index.php/faq"). Viac informácií o administrácií používateľov v rámci webového rozhrania EVE-ng nájdeme v súbore "sprava_pouzivatelov".

Ak SSH aj web rozhranie funguje (dovoli sa nam pripojit a prihlasit), pokracujeme zabezpecenim servera.

Sources:
  (Instalacia EVE-ng do Ubuntu)
  http://www.eve-ng.net/index.php/documentation/installation/bare-install

  (First login  & Post-install EVE-ng)
  http://www.eve-ng.net/index.php/documentation/howto-s/65-howto-configure-eve-during-first-boot
  https://bsnetworking.blog/2017/01/16/eve-ng-initial-configs/

  https://stackoverflow.com/questions/14059916/is-there-a-command-to-list-all-unix-group-names
