guestfish <<_EOF_
add disk.img
run
mount /dev/vg_guest/lv_root /
write /etc/motd "Welcome, new users"
_EOF_



cat /dev/null import_asdm_and_telnet_to_asav.sh
nano import_asdm_and_telnet_to_asav.sh


#!/bin/bash

if [ "$#" -lt 1 ]; then
  echo "Bad number of arguments"
  echo "Usage"
  echo "./script.sh ASAV_QCOW2 [ASDM_BIN]"
  echo "e.g."
  echo "./git_pull_all ~/github_root_dir"
  echo "If ASDM_BIN file is not provided, only telnet on ASAV_QCOW2 file will be activated."
  exit 1
fi

ASAV_QCOW2_ORIGINAL=$1
ASDM_BIN=$2

if [ -z "$ASDM_BIN" ]; then
  # create a copy of ASAv QCOW2 file ASAV_QCOW2_COPY -> append to copied filename <original_name>-serial.qcow2
  # enable only serial console for telnet access
  cat $ASAV_QCOW2_COPY <<_EOF_
  run
  mount /dev/sda2 /
  touch /use_ttyS0
  umount /
  exit
  _EOF_

else
  # create a copy of ASAv QCOW2 file ASAV_QCOW2_COPY -> append to copied filename <original_name>-asdm<version>-serial.qcow2
  # enable only serial console for telnet access
  #Â and import asdm bin
  cat $ASAV_QCOW2_COPY <<_EOF_
  run
  mount /dev/sda2 /
  touch /use_ttyS0
  copy-in local $ASDM_BIN /
  umount /
  exit
  _EOF_








guestfish -a $ASAV_QCOW2 <<_EOF_
run
mount /dev/sda2 /
touch /use_ttyS0
copy-in local $ASDM_BIN /
umount /
exit
_EOF_
